{% extends "Todo_app/base.html" %}
{% load static %}

{% block extra_head %}
<!-- Load your app-specific CSS -->
<link rel="stylesheet" href="{% static 'Todo_app/style.css' %}?v=3">
{% endblock %}

{% block content %}

<h3 class="mb-3">
  {% if active_category == 'morning_routine' %} Morning Routine
  {% elif active_category == 'career' %} Career
  {% elif active_category == 'personal_growth' %} Personal Growth
  {% elif active_category == 'recreation' %} Recreation
  {% elif active_status == 'pending' %} Pending Tasks
  {% elif active_status == 'completed' %} Completed Tasks
  {% else %} My Tasks
  {% endif %}
</h3>

<div class="task-list">
  {% for task in tasks %}
    <div class="task-row">
      <div class="task-item {% if task.status == 'completed' %}completed{% endif %}">
        
        <!-- Left-side clickable area -->
        <a href="{% url 'task-detail' task.id %}" class="task-link d-flex flex-grow-1 text-decoration-none">
          <div class="d-flex align-items-center flex-grow-1">

            {% if task.status != 'completed' %}
            <form method="post" action="{% url 'toggle-task' task.id %}" class="mark-completed-form me-3">
              {% csrf_token %}
              <button type="submit" class="btn btn-sm btn-checkmark">âœ”</button>
            </form>
            {% else %}
            <form method="post" action="{% url 'toggle-task' task.id %}" class="mark-completed-form me-2">
              {% csrf_token %}
              <button type="submit" class="btn btn-sm btn-checkmark completed">âœ“</button>
            </form>
            {% endif %}

            <div class="task-info">
              <div class="task-title">{{ task.title }}</div>
              <div class="task-subinfo">
                <span class="badge badge-{{ task.category }}">{{ task.get_category_display }}</span>
                <span class="badge badge-priority priority-{{ task.priority }}">{{ task.priority|title }}</span>
                {% if task.due_date %}<small class="text-muted">Due: {{ task.due_date|date:"M d, Y" }}</small>{% endif %}
              </div>
            </div>

          </div>
        </a>

        <!-- Right-side delete button -->
        <div class="d-flex align-items-center gap-2">
          <a href="{% url 'task-delete' task.id %}" class="btn btn-sm btn-outline-danger delete-task-btn">ðŸ—‘</a>
        </div>

      </div>
    </div>
  {% empty %}
    <div class="text-center py-5">
      {% if active_category %}
        <p class="text-muted fs-5">You have no <span class="fw-semibold">{{ active_category|title }}</span> tasks yet. 
        Click <a href="{% url 'task-create' %}" class="fw-semibold text-decoration-none">+ New Task</a> to get started!</p>
      {% elif active_status %}
        <p class="text-muted fs-5">You have no <span class="fw-semibold">{{ active_status|title }}</span> tasks yet.
        {% if active_status != 'completed' %}
          Click <a href="{% url 'task-create' %}" class="fw-semibold text-decoration-none">+ New Task</a> to get started!
        {% endif %}</p>
      {% else %}
        <p class="text-muted fs-5">You have no tasks yet. Click <a href="{% url 'task-create' %}" class="fw-semibold text-decoration-none">+ New Task</a> to get started!</p>
      {% endif %}
    </div>
  {% endfor %}
</div>

{% endblock %}
